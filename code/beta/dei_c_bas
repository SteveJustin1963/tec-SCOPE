// https://forum.arduino.cc/t/differential-encoder-interfacing-with-arduino/524002/8


#include "PinChangeInterrupt.h" // PinChange Interrupt library

signed long pulses;                              //Output pulses.
int pulsesChanged = 0;


int encoderA = 2;
int encoderB = 3;
int encoderZ = 4;



void setup() {

  Serial.begin(115200);
  Serial.flush();

  pinMode(encoderA, INPUT);
  pinMode(encoderB, INPUT);
  pinMode(encoderZ, INPUT);
  attachInterrupt(digitalPinToInterrupt(2), A_CHANGE, CHANGE);
  attachInterrupt(digitalPinToInterrupt(3), B_CHANGE, CHANGE);

}



void loop() {


}


void A_CHANGE() {
  if ( digitalRead(encoderB) == 0 ) {
    if ( digitalRead(encoderA) == 0 ) {
      // A fell, B is low
      pulses--; // moving reverse
    } else {
      // A rose, B is low
      pulses++; // moving forward
    }
  } else {
    if ( digitalRead(encoderA) == 0 ) {
      // B fell, A is high
      pulses++; // moving reverse
    } else {
      // B rose, A is high
      pulses--; // moving forward
    }
  }
  pulsesChanged = 1;

  data();
}


void B_CHANGE() {
  if ( digitalRead(encoderA) == 0 ) {
    if ( digitalRead(encoderB) == 0 ) {
      // B fell, A is low
      pulses++; // moving forward
    } else {
      // B rose, A is low
      pulses--; // moving reverse
    }
  } else {
    if ( digitalRead(encoderB) == 0 ) {
      // B fell, A is high
      pulses--; // moving reverse
    } else {
      // B rose, A is high
      pulses++; // moving forward
    }
  }
  pulsesChanged = 1;

  data1();
}


void data1() {
  if (pulsesChanged != 0) {
    pulsesChanged = 0;
    int readB = digitalRead(encoderB);
    Serial.print("B  ");
    Serial.println(readB);
    Serial.println(pulses);

    Serial.flush();
  }
}

void data() {
  if (pulsesChanged != 0) {
    pulsesChanged = 0;
    int readA = digitalRead(encoderA);

    Serial.print("A   ");
    Serial.println(readA);

    Serial.println(pulses);

    Serial.flush();
  }
}


-------------

convert the above to oshonsoft basic code


dim pulses as long
dim pulsesChanged as byte

const encoderA = 2
const encoderB = 3
const encoderZ = 4

sub on_interrupt()
  dim readA as byte
  dim readB as byte

  readA = digital_read(encoderA)
  readB = digital_read(encoderB)

  if ( readA = 0 ) then
    if ( readB = 0 ) then
      ' A fell, B is low
      pulses = pulses - 1
    else
      ' A rose, B is low
      pulses = pulses + 1
    end if
  else
    if ( readB = 0 ) then
      ' B fell, A is high
      pulses = pulses + 1
    else
      ' B rose, A is high
      pulses = pulses - 1
    end if
  end if

  pulsesChanged = 1
end sub

sub data()
  if (pulsesChanged <> 0) then
    pulsesChanged = 0
    print "A  "; digital_read(encoderA); "  "; pulses
    Serial.flush()
  end if
end sub

sub data1()
  if (pulsesChanged <> 0) then
    pulsesChanged = 0
    print "B  "; digital_read(encoderB); "  "; pulses
    Serial.flush()
  end if
end sub

sub setup()
  pin_mode(encoderA, INPUT)
  pin_mode(encoderB, INPUT)
  pin_mode(encoderZ, INPUT)
  set_interrupt_pin(2, on_interrupt, CHANGE)
  set_interrupt_pin(3, on_interrupt, CHANGE)
  Serial.begin(115200)
  Serial.flush()
end sub

sub loop()
  data()
  data1()
end sub
